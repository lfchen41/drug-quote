<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Drug Quote Generator</title>
  <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
  <style>
    body {
      font-family: system-ui, sans-serif;
    }
  </style>
</head>
<body class="bg-gray-100 p-6">
  <div class="max-w-3xl mx-auto bg-white p-6 rounded-lg shadow">
    <h1 class="text-2xl font-bold mb-4">Create Drug Quotation</h1>

    <div class="mb-6">
      <h2 class="font-semibold mb-2">Add New Customer:</h2>
      <input id="newCustomerName" class="border p-2 rounded mr-2" placeholder="Customer Name">
      <input id="newCustomerCompany" class="border p-2 rounded mr-2" placeholder="Company Name">
      <button onclick="addCustomer()" class="bg-green-600 text-white px-3 py-1 rounded">Add Customer</button>
    </div>

    <label class="block mb-2 font-semibold">Select Customer:</label>
    <select id="customerSelect" class="w-full mb-4 border p-2 rounded">
      <option value="">-- Select a customer --</option>
    </select>

    <div class="mb-6">
      <h2 class="font-semibold mb-2">Add New Product:</h2>
      <input id="newProductName" class="border p-2 rounded mb-2 w-full" placeholder="Product Name"><br>
      <input id="newProductDosage" class="border p-2 rounded mb-2 w-full" placeholder="Dosage"><br>
      <input id="newProductPackaging" class="border p-2 rounded mb-2 w-full" placeholder="Packaging"><br>
      <input id="newProductShelf" class="border p-2 rounded mb-2 w-full" placeholder="Shelf Life"><br>
      <button onclick="addProduct()" class="bg-green-600 text-white px-3 py-1 rounded">Add Product</button>
    </div>

    <label class="block mb-2 font-semibold">Select Products:</label>
    <div id="productList" class="mb-4 space-y-2"></div>

    <div class="flex space-x-4">
      <button onclick="generateQuote()" class="bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700">
        Generate Quotation
      </button>
      <button onclick="copyQuote()" class="bg-gray-700 text-white px-4 py-2 rounded hover:bg-gray-800">
        Copy to Clipboard
      </button>
    </div>

    <div id="quoteOutput" class="mt-6 whitespace-pre-wrap border border-gray-300 p-4 rounded bg-gray-50"></div>
  </div>

  <script>
    let customers = JSON.parse(localStorage.getItem('customers')) || [
      { id: 1, name: 'Lee', company: 'Global Pharma Inc.' },
      { id: 2, name: 'Ray', company: 'EastMed Pharmaceuticals' }
    ];
    let products = JSON.parse(localStorage.getItem('products')) || [
      { id: 1, name: 'Paracetamol 500mg', dosage: '500mg', packaging: '10x10 Blister Pack', shelfLife: '24 months' },
      { id: 2, name: 'Amoxicillin 250mg', dosage: '250mg', packaging: 'Bottle of 100', shelfLife: '36 months' }
    ];
    function saveData() {
      localStorage.setItem('customers', JSON.stringify(customers));
      localStorage.setItem('products', JSON.stringify(products));
    }
    function refreshCustomers() {
      const select = document.getElementById('customerSelect');
      select.innerHTML = '<option value="">-- Select a customer --</option>';
      customers.forEach(c => {
        const option = document.createElement('option');
        option.value = c.id;
        option.textContent = `${c.name} (${c.company})`;
        select.appendChild(option);
      });
    }
    function refreshProducts() {
      const productList = document.getElementById('productList');
      productList.innerHTML = '';
      products.forEach(p => {
        const div = document.createElement('div');
        div.innerHTML = `<label class="flex items-center">
              <input type="checkbox" value="${p.id}" class="mr-2" />
              ${p.name}
            </label>`;
        productList.appendChild(div);
      });
    }
    function addCustomer() {
      const name = document.getElementById('newCustomerName').value.trim();
      const company = document.getElementById('newCustomerCompany').value.trim();
      if (!name || !company) return alert('Please fill in both name and company.');
      const id = Date.now();
      customers.push({ id, name, company });
      saveData();
      refreshCustomers();
      document.getElementById('newCustomerName').value = '';
      document.getElementById('newCustomerCompany').value = '';
    }
    function addProduct() {
      const name = document.getElementById('newProductName').value.trim();
      const dosage = document.getElementById('newProductDosage').value.trim();
      const packaging = document.getElementById('newProductPackaging').value.trim();
      const shelfLife = document.getElementById('newProductShelf').value.trim();
      if (!name || !dosage || !packaging || !shelfLife) return alert('Please fill in all product fields.');
      const id = Date.now();
      products.push({ id, name, dosage, packaging, shelfLife });
      saveData();
      refreshProducts();
      document.getElementById('newProductName').value = '';
      document.getElementById('newProductDosage').value = '';
      document.getElementById('newProductPackaging').value = '';
      document.getElementById('newProductShelf').value = '';
    }
    function generateQuote() {
      const customerId = document.getElementById('customerSelect').value;
      if (!customerId) return alert('Please select a customer.');
      const customer = customers.find(c => c.id == customerId);
      const checkedProductIds = Array.from(document.querySelectorAll('#productList input:checked')).map(input => +input.value);
      if (checkedProductIds.length === 0) return alert('Please select at least one product.');
      const selectedProducts = products.filter(p => checkedProductIds.includes(p.id));
      const date = new Date().toISOString().split('T')[0];
      let output = `Quotation for: ${customer.name} (${customer.company})\n\n`;
      selectedProducts.forEach((p, i) => {
        output += `Product ${i + 1}: ${p.name}\n- Dosage: ${p.dosage}\n- Packaging: ${p.packaging}\n- Shelf Life: ${p.shelfLife}\n\n`;
      });
      output += `Total Products Quoted: ${selectedProducts.length}\nDate: ${date}`;
      document.getElementById('quoteOutput').textContent = output;
    }
    function copyQuote() {
      const output = document.getElementById('quoteOutput').textContent;
      if (!output) return alert('No quote to copy.');
      navigator.clipboard.writeText(output).then(() => {
        alert('Quotation copied to clipboard!');
      });
    }
    refreshCustomers();
    refreshProducts();
  </script>
</body>
</html>
